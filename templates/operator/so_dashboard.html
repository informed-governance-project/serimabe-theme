{% extends 'security_objectives/so_dashboard_base.html' %}
{% load django_bootstrap5 %}
{% load i18n %}

{% block content_new_declaration %}
<div class="me-auto">
    <a role="button" class="btn btn-primary btn-sm create_so_declaration" data-bs-toggle="modal"
        data-bs-target="#create_so_declaration">
        {% translate "New declaration" %}
    </a>
</div>
{% endblock %}

{% block content_filter %}
    {% bootstrap_field filter.form.submitter_user label_class="fw-bold" wrapper_class="mb-3" %}
{% endblock %}

{% block content_table_actions %}
<a class="btn border-0 px-2 text-dark" 
    href="{% url 'so_declaration' %}?id={{ standard.id }}"
    title="{% if standard.status == 'UNDE' %}Edit{% else %}Review{% endif %}">
    {% if standard.status == 'UNDE' %}
    <i class="bi bi-pencil-fill"></i>
    {% else %}
    <i class="bi bi-eye-fill"></i>
    {% endif %}
</a>
<button class="btn border-0 px-2 text-dark review_comment_so_declaration {% if standard.review_comment or standard.deadline %}text-warning{% else %}text-dark disabled{% endif %}" 
    data-standard-answer-id="{{ standard.id }}"
    data-bs-toggle="modal" data-bs-target="#review_comment_so_declaration"  title="Review comment">
    <i class="bi bi-envelope-fill"></i>
</button>
<a class="btn border-0 px-2 text-dark " href="{% url 'download_so_declaration_pdf' standard.id %}" title="Download">
    <i class="bi bi-filetype-pdf"></i>
</a>
<button class="btn border-0 px-2 text-dark copy_so_declaration" data-standard-answer-id="{{ standard.id }}"
    data-bs-toggle="modal" data-bs-target="#copy_so_declaration" title="Copy">
    <i class="bi bi-copy"></i>
</button>
<a class="btn border-0 px-2 {% if standard.answered_percentage < 100 or not standard.status == 'UNDE' %}text-dark disabled{% else %}text-success{% endif %}"
    href="{% url 'submit_so_declaration' standard.id  %}" title="Submit" aria-disabled="true">
    <i class="bi bi-file-earmark-arrow-up-fill"></i>
</a>
<button class="btn border-0 px-2 text-dark so_access_log" data-standard-answer-id="{{ standard.id }}" title="Access Log">
    <i class="bi bi-file-earmark-person"></i>
</button>
<button class="btn border-0 px-2 delete_so_declaration text-dark"
    data-standard-answer-id="{{ standard.id }}"
    data-delete-url="{% url 'delete_so_declaration' 0 %}"
    data-bs-toggle="modal"
    data-bs-target="#delete_so_declaration"
    title="Delete"
    {% if not standard.status == 'UNDE' %} disabled{% endif %}>
    <i class="bi bi-trash3-fill"></i>
</button>
{% endblock %}

<!-- Modals -->
{% block content_modals %}
{{ block.super }}
<div class="modal fade" id="delete_so_declaration" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="delete_so_declaration_label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        {% include "modals/delete_so_declaration.html" %}
    </div>
</div>

<div class="modal fade" id="copy_so_declaration" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="copy_so_declaration_label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
    </div>
</div>
{% endblock %}